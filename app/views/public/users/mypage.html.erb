<div class="container">
  <h1>MyPage</h1>
  <div class="row mt-3">
    <div class="col-md-3">
      <div>
        <%= link_to user_followings_path(@user) do %>
          <i class="fa-solid fa-address-book" style="color: #fdcedc;"></i>
          <%= @user.followings.count %>
        <% end %>
      </div>
      <div>
        <%= link_to user_followers_path(@user) do %>
        <i class="fa-solid fa-address-book" style="color: #cefafd;"></i>
        <%= @user.followers.count %>
        <% end %>
      </div>
      <div>
        <%= link_to bookmark_posts_users_path do %>
          <i class="fas fa-star" style="color: #ffedab;"></i>
        <% end %>
      </div>
      <%= image_tag current_user.get_profile_image(200,200), class: "img-fluid" %>
      <div>
        <h5>ユーザー名</h5>
        <%= current_user.name %>
      </div>
      <div>
        <h5>自己紹介</h5>
        <%= current_user.introduction %>
      </div>
      <% if @user.email != "guest@example.com" %>
        <div>
          <%= link_to "プロフィール編集", edit_user_path(current_user) %>
        </div>
        <div>
          <%= link_to "退会", withdraw_users_path, method: :patch, data: {confirm: "本当に退会しますか？"} %>
        </div>
      <% end %>
    </div>
    <div class="col-md-9">
      <h2>My Posts</h2>
      <div class="row">
        <% current_user.posts.each do |post| %>
          <div class="col-md-4 mb-3">
            <div class="card">
              <div class="card-image">
                <% if post.medias.attached? %>
                  <% post.medias.each do |media| %>
                    <% if media.content_type.include?('image') %>
                      <%= image_tag media, class: "img-fluid", size: "200x200" %>
                    <% else %>
                      <%= video_tag rails_blob_path(media), controls: true, class: "img-fluid", size: "200x200" %>
                    <% end %>
                  <% end %>
                <% else %>
                  <%= image_tag 'no_image.jpg', size: "200x200" %>
                <% end %>
              </div>
              <div class="card-body">
                <%= link_to post.post_content.truncate(20), post_path(post) %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>